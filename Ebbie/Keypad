#include <Keypad.h>
#include <SPI.h>
#include <MFRC522.h>
#include <Wire.h>

#define SS_PIN 10
#define RST_PIN 9

MFRC522 mfrc522(SS_PIN, RST_PIN);   // Create MFRC522 instance.
 
const byte ROWS = 4; //four rows
const byte COLS = 4; //three columns

int ammountToPin;
int printBon;

char keys[ROWS][COLS] = {
  {'1','2','3','A'},
  {'4','5','6','B'},
  {'7','8','9','C'},
  {'*','0','#','D'}
};

byte rowPins[ROWS] = {2, 3, 4, 5}; //connect to the row pinouts of the keypad
byte colPins[COLS] = {6,7,8, A0}; //connect to the column pinouts of the keypad

Keypad keypad = Keypad( makeKeymap(keys), rowPins, colPins, ROWS, COLS );

  void setup(){
    Serial.begin(9600);
  
    SPI.begin();      // Initiate  SPI bus
    mfrc522.PCD_Init();   // Initiate MFRC522
    
    Wire.begin(0);
    Wire.onReceive(receiveData);
  
  }
  
    void loop(){
  
        //zet het onderstuk code niet in een loop. Stuur gewoon 1 keer wanneer de gebruiker een bedrag en bonkeuze heeft gemaakt
        
        Wire.beginTransmission(8);
        Wire.write(ammountToPin); //het bedrag wat de gebruiker wil pinnen
        Wire.write(printBon); //wil de gebruiker een bon? 1 voor ja en 0 voor nee. Dit is een int geen boolean
        Wire.endTransmission();
      
        char key = keypad.getKey();
          // just print the pressed key
         if (key){
          Serial.println(key);
        }
      
      String cardIdRead= "" ;
        
      if (mfrc522.PICC_IsNewCardPresent() && mfrc522.PICC_ReadCardSerial()) {
        
      for (byte i = 0; i < mfrc522.uid.size; i++) {
            cardIdRead.concat(String(mfrc522.uid.uidByte[i] < 0x10 ? "0" : ""));
            cardIdRead.concat(String(mfrc522.uid.uidByte[i], HEX));
          }
          
          Serial.println(cardIdRead);
          mfrc522.PICC_HaltA();
     }
}

      void receiveData(int numBytes)// kopieer deze hele functie
      {
            int data = Wire.read();
            if (data == 112){ //Wanneer de dispenser 112 stuurt (hij is klaar met uitgeven)
            //doe iets wat je wil
            }
      }
      
